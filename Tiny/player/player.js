//Version 1.0.1
function loadNewPres(){loading.LoadingStart(),document.getElementsByTagName("body")[0].style.backgroundColor=presSettings.BackColr;var t=getObj("resizer");t.style.height=presSettings.Height+"px",t.style.width=presSettings.Width+"px",pcc.r(),window.onresize=pcc.r,getObj("plyBtn").onclick=Presentation.Play,getObj("nxtBtn").onclick=Presentation.Next,getObj("prvBtn").onclick=Presentation.Prev,getObj("TtlSld").innerHTML="<b>/</b>"+presSettings.TotalSlides;var e=parseInt(presSettings.TotalSlides);e=e.toString();var n=getObj("curSld");n.setAttribute("maxlength",e.length),n.onkeypress=function(t){var e=t.keyCode||t.which;if(13==e){var n=this.value;n=parseInt(n),isNaN(n)||Presentation.GotoSlide(n)}}}var presSettings={},Presentation,isTouchDevice,isPlaying=!1,getObj=function(t){return document.getElementById(t)};window.onload=function(){function t(t,e){getObj("notesBtn").style.backgroundColor="#DADADA",getObj("presenterBtn").style.backgroundColor="#DADADA",getObj("attachmentsBtn").style.backgroundColor="#DADADA",t.style.backgroundColor="#f5f5f5",getObj("noteDisplay").style.display="none",getObj("presenterDetails").style.display="none",getObj("attachmentsDisplay").style.display="none",getObj(e).style.display="block"}if(!document.createElement("canvas").getContext)return getObj("resizer").innerHTML="",getObj("toolbar").innerHTML="",getObj("toolbar").style.width="0px",void document.write("Oops! Your browser does not support HTML5. You need to upgrade your browser to view this content.");Presentation=new DopPresentation(new eventsHandler),Presentation.SetRPath("data/");try{document.createEvent("TouchEvent"),isTouchDevice=!0}catch(e){isTouchDevice=!1}Presentation.LoadPres("pres",1),getObj("presenterBtn").onclick=function(){t(this,"presenterDetails")},getObj("notesBtn").onclick=function(){t(this,"noteDisplay")},getObj("attachmentsBtn").onclick=function(){t(this,"attachmentsDisplay")};var n=getObj("morBtn");n.DopPhPanlFlg=!1,n.onclick=function(t){var e,n,i=t.target;"- - - -"==i.innerHTML?(i.innerHTML="+ + + +",getObj("controls").style.display="none",e=getObj("dfltShon"),e.style.top="5px",n=getObj("toolbar"),n.style.height="69px",getObj("panel").style.display="none",i.DopPhPanlFlg=!1):i.DopPhPanlFlg?(i.DopPhPanlFlg=!1,getObj("panel").style.display="block",i.innerHTML="- - - -"):(i.innerHTML="+ + + +",getObj("controls").style.display="block",getObj("dfltShon").style.top="101px",n=getObj("toolbar"),n.style.height="165px",i.DopPhPanlFlg=!0)}};var eventsHandler=function(){this.OnError=function(){},this.OnLoadingStart=function(){loading.LoadingStart()},this.OnLoadingEnd=function(){loading.LoadingEnd()},this.OnSlideChange=function(t){pcc.HandleSlideChange(t)},this.OnMovToNxtAnim=function(){},this.OnMovToPrvAnim=function(){},this.OnPlayingStart=function(){pcc.HandlePlayAndPause(!0)},this.OnPlayingEnd=function(){pcc.HandlePlayAndPause(!1)},this.OnProgressChange=function(){},this.InitaliseSettings=function(t){presSettings=t,loadNewPres()}},loading=function(){function t(){getObj("loadingImg").style.display="block"}function e(){getObj("loadingImg").style.display="none"}return{LoadingStart:t,LoadingEnd:e}}();Pcl=function(){function t(t){for(var e=presSettings.TotalSlides.toString(),n=t.toString(),i=n.length;i<e.length;)n="0"+n,i=n.length;return n}function e(){function t(){document.body.removeChild(window.iabho)}isTouchDevice&&(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i))&&(window.iabho=document.createElement("div"),document.body.appendChild(window.iabho),window.iabho.style.height="1000px",setTimeout(t(),100),window.scrollTo(0,1))}function n(t){var e=t.toString();return e.indexOf("e")>0?Math.floor(t):t}this.HandleSlideChange=function(e){getObj("curSld").value=t(e);var n=Presentation.GetNotes(e);getObj("noteDisplay").innerHTML=n},this.HandlePlayAndPause=function(t){getObj("plyBtn").innerHTML=t?"<b>||</b>":"►"},this.r=function(){e();var t,i,s,o=window.innerWidth,r=window.innerHeight,a=getObj("player");presSettings.MaxScale>0?(t=r>presSettings.Height*presSettings.MaxScale?presSettings.Height*presSettings.MaxScale:r,i=o>presSettings.Width*presSettings.MaxScale?presSettings.Width*presSettings.MaxScale:o):(t=r,i=o);var l;l=i<presSettings.Width||t<presSettings.Height?(presSettings.Width-i)/presSettings.Width<(presSettings.Height-t)/presSettings.Height?1-(presSettings.Height-t)/presSettings.Height:1-(presSettings.Width-i)/presSettings.Width:(i-presSettings.Width)/presSettings.Width>(t-presSettings.Height)/presSettings.Height?1+(t-presSettings.Height)/presSettings.Height:1+(i-presSettings.Width)/presSettings.Width,Presentation.SetScale(l),0==presSettings.MaxScale&&(i=presSettings.Width*l),a.style.height=n(t)+"px",a.style.width=n(i)+"px",a.style.top=n((r-t)/2)+"px",a.style.left=n((o-i)/2)+"px",s=getObj("resizer"),s.style.webkitTransform="scale("+n(l)+")",s.style.MozTransform="scale("+n(l)+")",s.style.OTransform="scale("+n(l)+")",s.style.msTransform="scale("+n(l)+")";var g=getObj("contentHolder");g.style.height=n(presSettings.Height*l)+"px",g.style.width=n(presSettings.Width*l)+"px",g.style.marginLeft=n((i-l*presSettings.Width)/2)+"px",g.style.marginTop=n((t-l*presSettings.Height)/2)+"px";var p=getObj("loadingImg");p.style.height=n(presSettings.Height*l)+"px",p.style.width=n(presSettings.Width*l)+"px",p.style.marginTop=s.style.marginTop,p.style.marginLeft=s.style.marginLeft,null!=getObj("play")&&(s=getObj("play"),s.style.height=n(l*presSettings.Height)+"px",s.style.width=n(l*presSettings.Width)+"px")}};var pcc=new Pcl;